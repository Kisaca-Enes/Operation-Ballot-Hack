ORE_KEYWORDS = {
    "basic": [
        "elf", "rop", "puts", "got", "libc", "system", "/bin/sh",
        "main", "interactive", "context.binary"
    ],
    "advanced": [
        "ret2libc", "jmp rsp", "mprotect", "virtualalloc",
        "shellcode polymorphic", "obfuscate", "encode", "decrypt"
    ],
    "aslr_bypass": [
        "leak libc address", "infoleak", "ret2libc", "partial overwrite", "jmp rsp",
        "return oriented programming", "memory disclosure", "stack pivot", "format string", "rop chain", "gadget"
    ],
    "kaspersky_bypass": [
        "process hollowing", "code injection", "dll injection", "reflective dll", "api hooking bypass",
        "unhook", "shellcode polymorphic", "obfuscate", "encrypt payload", "packing",
        "sandbox evasion", "anti-debug", "anti-vm", "syscall", "direct syscalls"
    ]
}


def calculate_score(exploit_input):
    score = 0
    exploit_lower = exploit_input.lower()

    # Basic terimler 1 puan
    for term in ORE_KEYWORDS["basic"]:
        if term in exploit_lower:
            score += 1

    # Advanced terimler 10 puan
    for term in ORE_KEYWORDS["advanced"]:
        if term in exploit_lower:
            score += 10

    return score

def check_bypass_terms(exploit_input):
    exploit_lower = exploit_input.lower()

    aslr_found = any(term in exploit_lower for term in ORE_KEYWORDS["aslr_bypass"])
    kaspersky_found = any(term in exploit_lower for term in ORE_KEYWORDS["kaspersky_bypass"])

    return aslr_found, kaspersky_found

def main():
    print("Exploit metnini giriniz (bitirmek için 'END' yazınız):")
    lines = []
    while True:
        line = input()
        if line.strip().upper() == "END":
            break
        lines.append(line)
    exploit = "\n".join(lines)

    total_score = calculate_score(exploit)
    aslr, kaspersky = check_bypass_terms(exploit)

    print(f"\nToplam Puan: {total_score}")

    if total_score >= 60:
        print("flag{rootforhacker090}")

    if not aslr:
        print("ASLR kodunu algıladı!")
    if not kaspersky:
        print("Kaspersky kodunuzu algıladı!")

if __name__ == "__main__":
    main()
